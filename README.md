# Easy Kleep (Docker Image)
I made this docker deployment as an easy way to setup Kleep, an University portal, to help removing effort of whoever wants to contribute. At the end of this guide you'll have a Kleep instance running.
If you want to put Kleep into production somewhere else, you'll have to take further security precautions which aren't dealt on this deployment. It is mostly a development aid.

## 1 - Setup docker on your system 
Install it using these [instructions](https://docs.docker.com/install/#supported-platforms).
If you're on Linux (as you should) and your distribution is not mentioned there lookup "docker [your distribution] install".
MacOS and Windows will probably work just fine, but I haven't tested them.
Whenever you're done, launch the docker daemon (or whatever equivalent your operating system has).

## 2 - Download needed images
Kleep requires at least an application server and a database.
> $ docker pull claudioap/kleep
> $ docker pull postgresql

Ideally you're also going to need a webserver to serve your static files.
> $ docker pull nginx

## 3 - Put configurations in place
There's a bash script in this repository. It'll aid you.
> $ ./bootstrap.sh ~./my/development/folder

This will move stuff around into a monolithic folder which aggregates logs, configurations and source code.
Inside of `~./my/development/folder
` you'll find a folder hierarchy that looks like this:
> configurations
> -- uwsgi
> -- nginx
> logs (the logs generated by the running services)
> source (kleep's source code)
> http
> -- static (django's static folder)
> -- media (django's media folder)
> databases
> -- vulnerabilities.db (optional, vulnerable hashes and whatever comes later)
> `launch.sh`

That `launch.sh` script in the root does what it says. It starts the docker images.
Take a look inside, it might be of interest for you to launch stuff apart, or retain containers after you stop them.
This might be useful: https://docs.docker.com/engine/reference/commandline/run/

You're also probably going to need to edit `.source/settings.json`.

## 4 - Do stuff
If you need a frontend to work with the database, look here: https://www.pgadmin.org/
The database server listens on `port 5432`. Default user is "kleep", password "changeme".
Nginx helps! It is waiting for you! http://localhost
Already told you where the sources are! What are you waiting for? Where are your pull requests?!?

## Things you probably don't need to know
You can access the application server directly (`port 1893`), but your browser probably isn't going to be able to open it directly unless you change `socket` to `http` at `configurations/uwsgi/kleep.in`.

## TODO
Docker compose would probably be a good fit to this repository.
